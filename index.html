<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mega Tech - Web Shop</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<header>
    <div style="display:flex; align-items:center;">
        <img class="logo" src="logo.png">
        <div id="pri">
            <h1>MEGA TECH</h1>
            <p>Comércio e prestação de serviços</p>
        </div>
    </div>
</header>

<section class="hero">
    <h2>Nosso objetivo é levar tecnologia de qualidade a preços justos, ajudando você a ter mais desempenho, praticidade e conectividade.</h2>
    <p>Localização: Lubango - Bairro Comercial, por detrás do Comando Provincial dos Bombeiros</p>
</section>

<section class="produtos" id="listaProdutos">
    <p style="text-align:center; padding:50px;">Carregando produtos...</p>
</section>

<a class="whatsapp-flutuante" href="https://wa.me/244924811382?text=Olá%20Mega%20Tech,%20vi%20um%20dos%20seus%20produtos%20no%20vosso%20site%20e%20estou%20interessado,%20pode%20me%20dar%20mais%20informações?" target="_blank">
    <img src="logow.png">
</a>

<footer>
    <div>
        <p>© 2025 Mega Tech - Comércio e Prestação de Serviços - Lubango</p>
        Suporte: filipeoliveira191117@gmail.com | WhatsApp: +244 924 811 382
        <p><a href="https://www.facebook.com/profile.php?id=100081510871668">Facebook</a></p>
    </div>
</footer>

<script>
    const supabaseUrl = 'https://tizkxplysjadtlrziomg.supabase.co';
    const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpemt4cGx5c2phZHRscnppb21nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwMDgyNTIsImV4cCI6MjA4MDU4NDI1Mn0.XyLjvbLV7FR0GEpc28XPQJQVSrZnbWhsAUVpjMI4OW4';
    const supabase = window.supabase.createClient(supabaseUrl, supabaseAnonKey);

    async function carregarProdutos() {
        const { data, error } = await supabase.from('produtos').select('*').order('created_at', { ascending: false });

        const div = document.getElementById("listaProdutos");
        div.innerHTML = "";

        if (error || !data || data.length === 0) {
            div.innerHTML = "<p style='text-align:center;padding:80px;font-size:18px;'>Ainda sem produtos... O administrador vai adicionar em breve!</p>";
            return;
        }

        data.forEach(p => {
            div.innerHTML += `
                <div class="produto-card">
                    <img src="\( {p.imagem}" alt=" \){p.nome}">
                    <div class="produto-info">
                        <h3>${p.nome}</h3>
                        <p><b>Preço:</b> ${p.preco}</p>
                        <p>${p.descricao || ''}</p>
                        <a class="btn-whatsapp" 
                           href="https://wa.me/244924811382?text=Olá%20Mega%20Tech,%20estou%20interessado%20no%20\( {encodeURIComponent(p.nome)}%20por%20 \){p.preco}"
                           target="_blank">Contactar no WhatsApp</a>
                    </div>
                </div>
            `;
        });
    }

    carregarProdutos();
</script>
</body>
</html>